<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <!-- Bootstrap core CSS -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
  <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
  <link href="https://fonts.googleapis.com/css?family=Baloo+Bhai&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Jua&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Raleway&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Noto+Sans+KR:300&display=swap" rel="stylesheet">
  <script src="http://cdn.jsdelivr.net/g/filesaver.js"></script>

</head>

<script>
  $(document).ready(function() {
    setEvents()

  })

  function setEvents() {
    $("#uploadBtn").click(function() {
      //파일 선택창을 연다.

      $("#fileElem").click()
    });

  }

  function handleFiles(files) {

    var fd = new FormData();
    fd.append('file', files[0]);

    console.log("Start!!" + files[0] + "End!!")

    $.ajax({
      url: 'http://20.194.105.72:20000/uploadImage',
      type: 'post',
      data: fd,
      processData: false,  // tell jQuery not to process the data
      contentType: false,
      success: function(response) {
        console.log(response)
        var file = new Blob([atob(response)], {type:'image/*'});
        saveAs(file, 'image.jpeg');
      },
    });

  }
</script>

<body>

  <div class="row h-100">
    <div class="col-sm-12 my-auto">
      <p> 사진을 업로드해주세요 </p>


      <form>
        <input type="file" accept-charset="utf-8" id="fileElem" enctype="multipart/form-data"  multiple accept="image/*" style="display:none"  onchange="handleFiles(this.files)">
      </form>

      <button type="button" class="btn btn-outline-primary" id="uploadBtn">업로드하기</button>

      <img id="img" width=100%>

    </div>
  </div>



</body>

</html>
